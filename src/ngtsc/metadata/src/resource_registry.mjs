/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
export function isExternalResource(resource) {
    return resource.path !== null;
}
/**
 * Tracks the mapping between external template/style files and the component(s) which use them.
 *
 * This information is produced during analysis of the program and is used mainly to support
 * external tooling, for which such a mapping is challenging to determine without compiler
 * assistance.
 */
export class ResourceRegistry {
    constructor() {
        this.externalTemplateToComponentsMap = new Map();
        this.componentToTemplateMap = new Map();
        this.componentToStylesMap = new Map();
        this.externalStyleToComponentsMap = new Map();
    }
    getComponentsWithTemplate(template) {
        if (!this.externalTemplateToComponentsMap.has(template)) {
            return new Set();
        }
        return this.externalTemplateToComponentsMap.get(template);
    }
    registerResources(resources, component) {
        if (resources.template !== null) {
            this.registerTemplate(resources.template, component);
        }
        for (const style of resources.styles) {
            this.registerStyle(style, component);
        }
    }
    registerTemplate(templateResource, component) {
        const { path } = templateResource;
        if (path !== null) {
            if (!this.externalTemplateToComponentsMap.has(path)) {
                this.externalTemplateToComponentsMap.set(path, new Set());
            }
            this.externalTemplateToComponentsMap.get(path).add(component);
        }
        this.componentToTemplateMap.set(component, templateResource);
    }
    getTemplate(component) {
        if (!this.componentToTemplateMap.has(component)) {
            return null;
        }
        return this.componentToTemplateMap.get(component);
    }
    registerStyle(styleResource, component) {
        const { path } = styleResource;
        if (!this.componentToStylesMap.has(component)) {
            this.componentToStylesMap.set(component, new Set());
        }
        if (path !== null) {
            if (!this.externalStyleToComponentsMap.has(path)) {
                this.externalStyleToComponentsMap.set(path, new Set());
            }
            this.externalStyleToComponentsMap.get(path).add(component);
        }
        this.componentToStylesMap.get(component).add(styleResource);
    }
    getStyles(component) {
        if (!this.componentToStylesMap.has(component)) {
            return new Set();
        }
        return this.componentToStylesMap.get(component);
    }
    getComponentsWithStyle(styleUrl) {
        if (!this.externalStyleToComponentsMap.has(styleUrl)) {
            return new Set();
        }
        return this.externalStyleToComponentsMap.get(styleUrl);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzb3VyY2VfcmVnaXN0cnkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9jb21waWxlci1jbGkvc3JjL25ndHNjL21ldGFkYXRhL3NyYy9yZXNvdXJjZV9yZWdpc3RyeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7O0dBTUc7QUF1QkgsTUFBTSxVQUFVLGtCQUFrQixDQUFDLFFBQWtCO0lBQ25ELE9BQU8sUUFBUSxDQUFDLElBQUksS0FBSyxJQUFJLENBQUM7QUFDaEMsQ0FBQztBQVlEOzs7Ozs7R0FNRztBQUNILE1BQU0sT0FBTyxnQkFBZ0I7SUFBN0I7UUFDVSxvQ0FBK0IsR0FBRyxJQUFJLEdBQUcsRUFBeUMsQ0FBQztRQUNuRiwyQkFBc0IsR0FBRyxJQUFJLEdBQUcsRUFBOEIsQ0FBQztRQUMvRCx5QkFBb0IsR0FBRyxJQUFJLEdBQUcsRUFBbUMsQ0FBQztRQUNsRSxpQ0FBNEIsR0FBRyxJQUFJLEdBQUcsRUFBeUMsQ0FBQztJQWlFMUYsQ0FBQztJQS9EQyx5QkFBeUIsQ0FBQyxRQUF3QjtRQUNoRCxJQUFJLENBQUMsSUFBSSxDQUFDLCtCQUErQixDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUN2RCxPQUFPLElBQUksR0FBRyxFQUFFLENBQUM7U0FDbEI7UUFFRCxPQUFPLElBQUksQ0FBQywrQkFBK0IsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFFLENBQUM7SUFDN0QsQ0FBQztJQUVELGlCQUFpQixDQUFDLFNBQTZCLEVBQUUsU0FBMkI7UUFDMUUsSUFBSSxTQUFTLENBQUMsUUFBUSxLQUFLLElBQUksRUFBRTtZQUMvQixJQUFJLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxDQUFDLFFBQVEsRUFBRSxTQUFTLENBQUMsQ0FBQztTQUN0RDtRQUNELEtBQUssTUFBTSxLQUFLLElBQUksU0FBUyxDQUFDLE1BQU0sRUFBRTtZQUNwQyxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssRUFBRSxTQUFTLENBQUMsQ0FBQztTQUN0QztJQUNILENBQUM7SUFFRCxnQkFBZ0IsQ0FBQyxnQkFBMEIsRUFBRSxTQUEyQjtRQUN0RSxNQUFNLEVBQUMsSUFBSSxFQUFDLEdBQUcsZ0JBQWdCLENBQUM7UUFDaEMsSUFBSSxJQUFJLEtBQUssSUFBSSxFQUFFO1lBQ2pCLElBQUksQ0FBQyxJQUFJLENBQUMsK0JBQStCLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFO2dCQUNuRCxJQUFJLENBQUMsK0JBQStCLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxJQUFJLEdBQUcsRUFBRSxDQUFDLENBQUM7YUFDM0Q7WUFDRCxJQUFJLENBQUMsK0JBQStCLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBRSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztTQUNoRTtRQUNELElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLGdCQUFnQixDQUFDLENBQUM7SUFDL0QsQ0FBQztJQUVELFdBQVcsQ0FBQyxTQUEyQjtRQUNyQyxJQUFJLENBQUMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsRUFBRTtZQUMvQyxPQUFPLElBQUksQ0FBQztTQUNiO1FBQ0QsT0FBTyxJQUFJLENBQUMsc0JBQXNCLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBRSxDQUFDO0lBQ3JELENBQUM7SUFFRCxhQUFhLENBQUMsYUFBdUIsRUFBRSxTQUEyQjtRQUNoRSxNQUFNLEVBQUMsSUFBSSxFQUFDLEdBQUcsYUFBYSxDQUFDO1FBQzdCLElBQUksQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxFQUFFO1lBQzdDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLElBQUksR0FBRyxFQUFFLENBQUMsQ0FBQztTQUNyRDtRQUNELElBQUksSUFBSSxLQUFLLElBQUksRUFBRTtZQUNqQixJQUFJLENBQUMsSUFBSSxDQUFDLDRCQUE0QixDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRTtnQkFDaEQsSUFBSSxDQUFDLDRCQUE0QixDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsSUFBSSxHQUFHLEVBQUUsQ0FBQyxDQUFDO2FBQ3hEO1lBQ0QsSUFBSSxDQUFDLDRCQUE0QixDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUUsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUM7U0FDN0Q7UUFDRCxJQUFJLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBRSxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUMvRCxDQUFDO0lBRUQsU0FBUyxDQUFDLFNBQTJCO1FBQ25DLElBQUksQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxFQUFFO1lBQzdDLE9BQU8sSUFBSSxHQUFHLEVBQUUsQ0FBQztTQUNsQjtRQUNELE9BQU8sSUFBSSxDQUFDLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUUsQ0FBQztJQUNuRCxDQUFDO0lBRUQsc0JBQXNCLENBQUMsUUFBd0I7UUFDN0MsSUFBSSxDQUFDLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFDcEQsT0FBTyxJQUFJLEdBQUcsRUFBRSxDQUFDO1NBQ2xCO1FBRUQsT0FBTyxJQUFJLENBQUMsNEJBQTRCLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBRSxDQUFDO0lBQzFELENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCBHb29nbGUgTExDIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYW4gTUlULXN0eWxlIGxpY2Vuc2UgdGhhdCBjYW4gYmVcbiAqIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgYXQgaHR0cHM6Ly9hbmd1bGFyLmlvL2xpY2Vuc2VcbiAqL1xuXG5pbXBvcnQgKiBhcyB0cyBmcm9tICd0eXBlc2NyaXB0JztcblxuaW1wb3J0IHtBYnNvbHV0ZUZzUGF0aH0gZnJvbSAnLi4vLi4vZmlsZV9zeXN0ZW0nO1xuaW1wb3J0IHtDbGFzc0RlY2xhcmF0aW9ufSBmcm9tICcuLi8uLi9yZWZsZWN0aW9uJztcblxuLyoqXG4gKiBSZXByZXNlbnRzIGFuIHJlc291cmNlIGZvciBhIGNvbXBvbmVudCBhbmQgY29udGFpbnMgdGhlIGBBYnNvbHV0ZUZzUGF0aGBcbiAqIHRvIHRoZSBmaWxlIHdoaWNoIHdhcyByZXNvbHZlZCBieSBldmFsdWF0aW5nIHRoZSBgdHMuRXhwcmVzc2lvbmAgKGdlbmVyYWxseSwgYSByZWxhdGl2ZSBvclxuICogYWJzb2x1dGUgc3RyaW5nIHBhdGggdG8gdGhlIHJlc291cmNlKS5cbiAqXG4gKiBJZiB0aGUgcmVzb3VyY2UgaXMgaW5saW5lLCB0aGUgYHBhdGhgIHdpbGwgYmUgYG51bGxgLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFJlc291cmNlIHtcbiAgcGF0aDogQWJzb2x1dGVGc1BhdGh8bnVsbDtcbiAgZXhwcmVzc2lvbjogdHMuRXhwcmVzc2lvbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFeHRlcm5hbFJlc291cmNlIGV4dGVuZHMgUmVzb3VyY2Uge1xuICBwYXRoOiBBYnNvbHV0ZUZzUGF0aDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRXh0ZXJuYWxSZXNvdXJjZShyZXNvdXJjZTogUmVzb3VyY2UpOiByZXNvdXJjZSBpcyBFeHRlcm5hbFJlc291cmNlIHtcbiAgcmV0dXJuIHJlc291cmNlLnBhdGggIT09IG51bGw7XG59XG5cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgZWl0aGVyIGlubGluZSBvciBleHRlcm5hbCByZXNvdXJjZXMgb2YgYSBjb21wb25lbnQuXG4gKlxuICogQSByZXNvdXJjZSB3aXRoIGEgYHBhdGhgIG9mIGBudWxsYCBpcyBjb25zaWRlcmVkIGlubGluZS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDb21wb25lbnRSZXNvdXJjZXMge1xuICB0ZW1wbGF0ZTogUmVzb3VyY2U7XG4gIHN0eWxlczogUmVhZG9ubHlTZXQ8UmVzb3VyY2U+O1xufVxuXG4vKipcbiAqIFRyYWNrcyB0aGUgbWFwcGluZyBiZXR3ZWVuIGV4dGVybmFsIHRlbXBsYXRlL3N0eWxlIGZpbGVzIGFuZCB0aGUgY29tcG9uZW50KHMpIHdoaWNoIHVzZSB0aGVtLlxuICpcbiAqIFRoaXMgaW5mb3JtYXRpb24gaXMgcHJvZHVjZWQgZHVyaW5nIGFuYWx5c2lzIG9mIHRoZSBwcm9ncmFtIGFuZCBpcyB1c2VkIG1haW5seSB0byBzdXBwb3J0XG4gKiBleHRlcm5hbCB0b29saW5nLCBmb3Igd2hpY2ggc3VjaCBhIG1hcHBpbmcgaXMgY2hhbGxlbmdpbmcgdG8gZGV0ZXJtaW5lIHdpdGhvdXQgY29tcGlsZXJcbiAqIGFzc2lzdGFuY2UuXG4gKi9cbmV4cG9ydCBjbGFzcyBSZXNvdXJjZVJlZ2lzdHJ5IHtcbiAgcHJpdmF0ZSBleHRlcm5hbFRlbXBsYXRlVG9Db21wb25lbnRzTWFwID0gbmV3IE1hcDxBYnNvbHV0ZUZzUGF0aCwgU2V0PENsYXNzRGVjbGFyYXRpb24+PigpO1xuICBwcml2YXRlIGNvbXBvbmVudFRvVGVtcGxhdGVNYXAgPSBuZXcgTWFwPENsYXNzRGVjbGFyYXRpb24sIFJlc291cmNlPigpO1xuICBwcml2YXRlIGNvbXBvbmVudFRvU3R5bGVzTWFwID0gbmV3IE1hcDxDbGFzc0RlY2xhcmF0aW9uLCBTZXQ8UmVzb3VyY2U+PigpO1xuICBwcml2YXRlIGV4dGVybmFsU3R5bGVUb0NvbXBvbmVudHNNYXAgPSBuZXcgTWFwPEFic29sdXRlRnNQYXRoLCBTZXQ8Q2xhc3NEZWNsYXJhdGlvbj4+KCk7XG5cbiAgZ2V0Q29tcG9uZW50c1dpdGhUZW1wbGF0ZSh0ZW1wbGF0ZTogQWJzb2x1dGVGc1BhdGgpOiBSZWFkb25seVNldDxDbGFzc0RlY2xhcmF0aW9uPiB7XG4gICAgaWYgKCF0aGlzLmV4dGVybmFsVGVtcGxhdGVUb0NvbXBvbmVudHNNYXAuaGFzKHRlbXBsYXRlKSkge1xuICAgICAgcmV0dXJuIG5ldyBTZXQoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5leHRlcm5hbFRlbXBsYXRlVG9Db21wb25lbnRzTWFwLmdldCh0ZW1wbGF0ZSkhO1xuICB9XG5cbiAgcmVnaXN0ZXJSZXNvdXJjZXMocmVzb3VyY2VzOiBDb21wb25lbnRSZXNvdXJjZXMsIGNvbXBvbmVudDogQ2xhc3NEZWNsYXJhdGlvbikge1xuICAgIGlmIChyZXNvdXJjZXMudGVtcGxhdGUgIT09IG51bGwpIHtcbiAgICAgIHRoaXMucmVnaXN0ZXJUZW1wbGF0ZShyZXNvdXJjZXMudGVtcGxhdGUsIGNvbXBvbmVudCk7XG4gICAgfVxuICAgIGZvciAoY29uc3Qgc3R5bGUgb2YgcmVzb3VyY2VzLnN0eWxlcykge1xuICAgICAgdGhpcy5yZWdpc3RlclN0eWxlKHN0eWxlLCBjb21wb25lbnQpO1xuICAgIH1cbiAgfVxuXG4gIHJlZ2lzdGVyVGVtcGxhdGUodGVtcGxhdGVSZXNvdXJjZTogUmVzb3VyY2UsIGNvbXBvbmVudDogQ2xhc3NEZWNsYXJhdGlvbik6IHZvaWQge1xuICAgIGNvbnN0IHtwYXRofSA9IHRlbXBsYXRlUmVzb3VyY2U7XG4gICAgaWYgKHBhdGggIT09IG51bGwpIHtcbiAgICAgIGlmICghdGhpcy5leHRlcm5hbFRlbXBsYXRlVG9Db21wb25lbnRzTWFwLmhhcyhwYXRoKSkge1xuICAgICAgICB0aGlzLmV4dGVybmFsVGVtcGxhdGVUb0NvbXBvbmVudHNNYXAuc2V0KHBhdGgsIG5ldyBTZXQoKSk7XG4gICAgICB9XG4gICAgICB0aGlzLmV4dGVybmFsVGVtcGxhdGVUb0NvbXBvbmVudHNNYXAuZ2V0KHBhdGgpIS5hZGQoY29tcG9uZW50KTtcbiAgICB9XG4gICAgdGhpcy5jb21wb25lbnRUb1RlbXBsYXRlTWFwLnNldChjb21wb25lbnQsIHRlbXBsYXRlUmVzb3VyY2UpO1xuICB9XG5cbiAgZ2V0VGVtcGxhdGUoY29tcG9uZW50OiBDbGFzc0RlY2xhcmF0aW9uKTogUmVzb3VyY2V8bnVsbCB7XG4gICAgaWYgKCF0aGlzLmNvbXBvbmVudFRvVGVtcGxhdGVNYXAuaGFzKGNvbXBvbmVudCkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5jb21wb25lbnRUb1RlbXBsYXRlTWFwLmdldChjb21wb25lbnQpITtcbiAgfVxuXG4gIHJlZ2lzdGVyU3R5bGUoc3R5bGVSZXNvdXJjZTogUmVzb3VyY2UsIGNvbXBvbmVudDogQ2xhc3NEZWNsYXJhdGlvbik6IHZvaWQge1xuICAgIGNvbnN0IHtwYXRofSA9IHN0eWxlUmVzb3VyY2U7XG4gICAgaWYgKCF0aGlzLmNvbXBvbmVudFRvU3R5bGVzTWFwLmhhcyhjb21wb25lbnQpKSB7XG4gICAgICB0aGlzLmNvbXBvbmVudFRvU3R5bGVzTWFwLnNldChjb21wb25lbnQsIG5ldyBTZXQoKSk7XG4gICAgfVxuICAgIGlmIChwYXRoICE9PSBudWxsKSB7XG4gICAgICBpZiAoIXRoaXMuZXh0ZXJuYWxTdHlsZVRvQ29tcG9uZW50c01hcC5oYXMocGF0aCkpIHtcbiAgICAgICAgdGhpcy5leHRlcm5hbFN0eWxlVG9Db21wb25lbnRzTWFwLnNldChwYXRoLCBuZXcgU2V0KCkpO1xuICAgICAgfVxuICAgICAgdGhpcy5leHRlcm5hbFN0eWxlVG9Db21wb25lbnRzTWFwLmdldChwYXRoKSEuYWRkKGNvbXBvbmVudCk7XG4gICAgfVxuICAgIHRoaXMuY29tcG9uZW50VG9TdHlsZXNNYXAuZ2V0KGNvbXBvbmVudCkhLmFkZChzdHlsZVJlc291cmNlKTtcbiAgfVxuXG4gIGdldFN0eWxlcyhjb21wb25lbnQ6IENsYXNzRGVjbGFyYXRpb24pOiBTZXQ8UmVzb3VyY2U+IHtcbiAgICBpZiAoIXRoaXMuY29tcG9uZW50VG9TdHlsZXNNYXAuaGFzKGNvbXBvbmVudCkpIHtcbiAgICAgIHJldHVybiBuZXcgU2V0KCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmNvbXBvbmVudFRvU3R5bGVzTWFwLmdldChjb21wb25lbnQpITtcbiAgfVxuXG4gIGdldENvbXBvbmVudHNXaXRoU3R5bGUoc3R5bGVVcmw6IEFic29sdXRlRnNQYXRoKTogUmVhZG9ubHlTZXQ8Q2xhc3NEZWNsYXJhdGlvbj4ge1xuICAgIGlmICghdGhpcy5leHRlcm5hbFN0eWxlVG9Db21wb25lbnRzTWFwLmhhcyhzdHlsZVVybCkpIHtcbiAgICAgIHJldHVybiBuZXcgU2V0KCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuZXh0ZXJuYWxTdHlsZVRvQ29tcG9uZW50c01hcC5nZXQoc3R5bGVVcmwpITtcbiAgfVxufVxuIl19